workflows:
  android_build:
    name: Android Build
    environment:
      docker:
        image: circleci/android:api-30-nodejs-16.3.0
      vars:
        ANDROID_HOME: "/usr/local/android-sdk"
        GRADLE_OPTS: "-Dorg.gradle.daemon=false"
    scripts:
      - name: Install Dependencies
        script: |
          npm install -g @ionic/cli cordova
          ionic cordova prepare android
      - name: Build Android
        script: |
          cd platforms/android
          chmod +x gradlew
          ./gradlew assembleRelease
    artifacts:
      - build/outputs/apk/release/*.apk
    publishing:
      email:
        recipients:
          - your-email@example.com
